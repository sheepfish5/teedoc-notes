# 函数里的`this`

## `function`关键字定义的函数

使用`function`关键字声明的函数的函数体是一层新的变量作用域。函数体里面用`var`声明的变量与外界隔开。

~~~text
┌───────────────────────────────┐
│ VariableScope1                │
│                               │
│   var a, b, c;                │
│                               │
│   ┌────────────────────────┐  │
│   │ function func()        │  │
│   │                        │  │
│   │ VariableScope2         │  │
│   │                        │  │
│   │      var a, b, c;      │  │
│   │                        │  │
│   │                        │  │
│   │                        │  │
│   └────────────────────────┘  │
│                               │
└───────────────────────────────┘
~~~

`use strict`模式下，使用`function`关键字声明的函数中，可以使用`this`关键字。这个`this`绑定的对象是动态的，如果该函数对象以对象方法的形式`obj.func()`被调用，那么里面的`this`就指向对象`obj`本身，或者说绑定到`obj`；如果该函数对象以正常函数的形式`func()`被调用，那么里面的`this`就为`undefined`。

## 箭头函数`=>`

箭头函数不是匿名函数的语法糖，完全是一个新的东西。箭头函数的变量作用域与上面说的完全不同：

~~~text
┌────────────────────────────────────────────┐
│ VariableScope1                             │
│                                            │
│   var [a,b,c] = [1,2,3];                   │
│                                            │
│                                            │
│   var func = () => { return a * b * c; };  │
│                                            │
│                                            │
│                                            │
└────────────────────────────────────────────┘
~~~

箭头函数不会搞出一个新的变量作用域，而是直接用外层原本的变量作用域`VariableScope1`。

这也使得箭头函数里理论上是没有`this`关键字的！如果用了`this`关键字，实际上用的是`VariableScope1`里的`this`。具体表现为`use strict`模式下，如果外层是全局作用域，那么`this`就是`undefined`；如果外层是个使用`function`关键字声明的函数，那么箭头函数里的`this`就是外层函数里的`this`。

多说一句，javascript给了程序员这么大的自由真的不好，学的时候要记这么多的且繁琐的规则，用的时候又容易出错。
