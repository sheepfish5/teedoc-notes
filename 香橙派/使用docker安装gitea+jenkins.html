<!DOCTYPE html>

<html lang="zh-CN"  class="">


<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    
    <meta name="keywords" content="">
    
    
    <meta name="description" content="">
    
    <meta name="generator" content="teedoc">
    <meta name="theme" content="teedoc-plugin-theme-default">
    
        
        <meta name="markdown-generator" content="teedoc-plugin-markdown-parser">
        
        <script>
MathJax = {"loader": {"load": ["output/svg"]}, "tex": {"inlineMath": [["$", "$"], ["\\(", "\\)"]]}, "svg": {"fontCache": "global"}};
</script>
        
        <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
        
        <script src="/static/js/theme_default/pre_main.js"></script>
        
        <link rel="stylesheet" href="/static/css/theme_default/prism.min.css" type="text/css"/>
        
        <link rel="stylesheet" href="/static/css/theme_default/viewer.min.css" type="text/css"/>
        
        <link rel="stylesheet" href="/static/css/theme_default/dark.css" type="text/css"/>
        
        <link rel="stylesheet" href="/static/css/theme_default/light.css" type="text/css"/>
        
        <script src="/static/js/theme_default/jquery.min.js"></script>
        
        <script src="/static/js/theme_default/split.js"></script>
        
        <link rel="stylesheet" href="/static/css/search/style.css" type="text/css"/>
        
        <link rel="stylesheet" href="/static/css/custom.css" type="text/css"/>
        
    
    
    <title>ä½¿ç”¨dockerå®‰è£…gitea+jenkins - sheepfish5-notes</title>
    
    <script type="text/javascript">js_vars = {}</script>
    <script type="text/javascript">metadata = {"tags": [], "date": null, "update": [], "ts": 0, "author": "", "brief": "", "cover": ""}</script>
</head>


<body class="type_doc">
    
    <div id="navbar">
        <div id="navbar_menu">
            <a class="site_title" href="/">
                
                    <img class="site_logo" src="/static/image/favicon.ico" alt="sheepfish5-notes">
                
                
                    <h2>sheepfish5-notes</h2>
                
        </a>
            <a id="navbar_menu_btn"></a>
        </div>
        <div id="navbar_items">
            <div>
                <ul id="nav_left">
<li class=""><a  href="/å¤šåª’ä½“å¤„ç†/">å¤šåª’ä½“å¤„ç†</a></li>
<li class=""><a  href="/å‰ç«¯/">å‰ç«¯</a></li>
<li class=""><a  href="/éšç¬”/">éšç¬”</a></li>
<li class="active"><a  href="/é¦™æ©™æ´¾/">é¦™æ©™æ´¾</a></li>
<li class=""><a  href="/C++/">C++</a></li>
<li class=""><a  href="/Docker/">Docker</a></li>
<li class=""><a  href="/Git/">Git</a></li>
<li class=""><a  href="/Java/">Java</a></li>
<li class=""><a  href="/JavaScript/">JavaScript</a></li>
<li class=""><a  href="/Linux/">Linux</a></li>
<li class=""><a  href="/Vue/">Vue</a></li>
</ul>

            </div>
            <div>
                <ul id="nav_right">
</ul>

                <ul class="nav_plugins"><li><a id="themes" class="light"></a></li></ul><ul class="nav_plugins"><li><a id="search"><span class="icon"></span><span class="placeholder">æœç´¢</span>
                            <div id="search_hints">
                                <span id="search_input_hint">è¾“å…¥å…³é”®è¯ï¼Œå¤šå…³é”®è¯ç©ºæ ¼éš”å¼€</span>
                                <span id="search_loading_hint">æ­£åœ¨åŠ è½½ï¼Œè¯·ç¨å€™ã€‚ã€‚ã€‚</span>
                                <span id="search_download_err_hint">ä¸‹è½½æ–‡ä»¶å¤±è´¥ï¼Œè¯·åˆ·æ–°é‡è¯•æˆ–æ£€æŸ¥ç½‘ç»œ</span>
                                <span id="search_other_docs_result_hint">æ¥è‡ªå…¶å®ƒæ–‡æ¡£çš„ç»“æœ</span>
                                <span id="search_curr_doc_result_hint">å½“å‰æ–‡æ¡£æœç´¢ç»“æœ</span>
                            </div></a></li></ul>
            </div>
        </div>
    </div>
    
    <div id="wrapper">
        <div id="sidebar_wrapper">
            <div id="sidebar">
                <div id="sidebar_title">
                    
                </div>
                <ul class="show">
<li class="not_active with_link"><a href="/é¦™æ©™æ´¾/index.html"><span class="label">ç®€ä»‹</span><span class=""></span></a></li>
<li class="not_active with_link"><a href="/é¦™æ©™æ´¾/åŸºç¡€è®¾ç½®.html"><span class="label">åŸºç¡€è®¾ç½®</span><span class=""></span></a></li>
<li class="active with_link"><a href="/é¦™æ©™æ´¾/ä½¿ç”¨dockerå®‰è£…gitea+jenkins.html"><span class="label">ä½¿ç”¨dockerå®‰è£…gitea+jenkins</span><span class=""></span></a></li>
<li class="not_active with_link"><a href="/é¦™æ©™æ´¾/armbian.html"><span class="label">armbian</span><span class=""></span></a></li>
<li class="not_active with_link"><a href="/é¦™æ©™æ´¾/samba.html"><span class="label">samba</span><span class=""></span></a></li>
</ul>

            </div>
        </div>
        <div id="article">
            <div id="menu_wrapper">
                <div id="menu">
                </div>
            </div>
            <div id="content_wrapper">
                <div id="content_body">
                    <div id="article_head">
                        <div id="article_title">
                            
                            <h1>ä½¿ç”¨dockerå®‰è£…gitea+jenkins</h1>
                            
                        </div>
                        <div id="article_tags">
                            <ul>
                            
                            </ul>
                        </div>
                        <div id="article_info">
                        <div id="article_info_left">
                            <span class="article_author">
                                
                            </span>
                            
                                <span class="article_date" title="æœ€åä¿®æ”¹æ—¥æœŸï¼š 2024-02-25">
                                    2024-02-25
                                </span>
                            
                        </div>
                        <div id="article_info_right">
                            
                        </div>
                        </div>
                    </div>
                    <div id="article_tools">
                        <span></span>
                        <span id="toc_btn"></span>
                    </div>
                    <div id="update_history">
                        
                    </div>
                    <div id="article_content">
                        
                            <p>å‚è€ƒï¼š<a href="https://www.cnblogs.com/Gitea/p/jenkins.html"  target="_blank">Gitea ä¸ Jenkins çš„é›†æˆå®è·µï¼Œæ‰“é€ ä½ çš„ä¸“å± CI/CD ç³»ç»Ÿ</a></p>
<h2 id="%E6%B3%A8%E6%84%8F">æ³¨æ„</h2>
<h3 id="1.-Jenkins%E7%9A%84%E7%89%88%E6%9C%AC%E9%97%AE%E9%A2%98">1. Jenkinsçš„ç‰ˆæœ¬é—®é¢˜</h3>
<p>Jenkinsä¸èƒ½åƒlinuxçš„åŒ…ç®¡ç†å™¨é‚£æ ·è‡ªåŠ¨å¤„ç†å„ç§ç‰ˆæœ¬å†²çªï¼Œå› æ­¤ç¬¬ä¸€æ¬¡å®‰è£…æ’ä»¶æ—¶ä¸å‡ºæ„å¤–ä¸€å®šä¼šå¤±è´¥ã€‚ä½†æ‰‹åŠ¨å¤„ç†å†²çªï¼ˆå†å®˜ç½‘ä¸Šä¾æ¬¡ä¸‹è½½é€‚åˆå½“å‰Jenkinsç‰ˆæœ¬çš„æ’ä»¶ï¼‰å®åœ¨æ˜¯è¿‡äºéº»çƒ¦ï¼Œå› æ­¤é€‰æ‹©æ‰‹åŠ¨å°†Jenkinså‡è‡³æœ€æ–°ç‰ˆï¼Œè¿™æ ·ä¸€èˆ¬èƒ½ç›´æ¥æ»¡è¶³æ‰€æœ‰æ’ä»¶å¯¹Jenkinsçš„ç‰ˆæœ¬è¦æ±‚ã€‚å…·ä½“åšæ³•æ˜¯ä»å®˜ç½‘ä¸‹è½½Jenkinsçš„æœ€æ–°ç‰ˆwaråŒ…ï¼Œè¿è¡Œdockerå®¹å™¨ï¼Œå°†ä¸‹è½½çš„waråŒ…æ›¿æ¢æ‰å®¹å™¨ä¸­çš„<code>/usr/share/jenkins/jenkins.war</code>ï¼Œç„¶åå†é‡å¯å®¹å™¨å³å¯ã€‚é‡å¯ä¹‹åï¼Œæ‰€æœ‰æ’ä»¶è‡ªåŠ¨å®‰è£…æˆåŠŸã€‚</p>
<blockquote>
<p>æ›¿æ¢æœ€æ–°ç‰ˆwaråŒ…å‚è€ƒï¼š<a href="https://blog.csdn.net/tomonkey/article/details/106942162"  target="_blank">Dockeréƒ¨ç½²çš„Jenkinså¦‚ä½•æ›´æ–°ç‰ˆæœ¬å‘¢</a></p>
</blockquote>
<h3 id="2.-Jenkins%E7%89%88%E6%9C%AC%E7%BB%88%E6%9E%81%E8%A7%A3%E5%86%B3%E6%96%B9%E6%B3%95">2. Jenkinsç‰ˆæœ¬ç»ˆæè§£å†³æ–¹æ³•</h3>
<p>å…ˆä¸ŠDocker Hubæœjenkinsï¼Œç„¶åä½¿ç”¨ä»–ä»¬æœ€æ–°ç‰ˆæœ¬çš„tagï¼Œæ³¨æ„ä¸è¦ç”¨é»˜è®¤çš„<code>latest</code>ï¼Œé‚£ä¸ªä¸æ˜¯æœ€æ–°ç‰ˆã€‚æ¯”å¦‚ç°åœ¨çš„æœ€æ–°ç‰ˆæ˜¯<code>jenkins/jenkins:2.414</code>ã€‚</p>
<p>ä¸è¦å†æ‰‹åŠ¨æ›¿æ¢äº†ï¼Œé‚£æ ·å¤ªéº»çƒ¦äº†ã€‚</p>
<h3 id="3.-gitea%E7%9A%84webhook%E6%97%A0%E6%B3%95%E8%A7%A6%E5%8F%91">3. giteaçš„webhookæ— æ³•è§¦å‘</h3>
<p>è¦åœ¨jenkinsçš„ç³»ç»Ÿé…ç½®é‡Œä¸ºGitea Serverå¢åŠ URLåˆ«åï¼Œå…·ä½“å¯ä»¥ç‚¹Alias URLæ—è¾¹çš„é—®å·ã€‚</p>
<blockquote>
<p>å‚è€ƒï¼š<a href="https://stackoverflow.com/a/68432979/21743075"  target="_blank">stackoverflow</a></p>
</blockquote>
<p><del>ä½†å³ä½¿æ˜¯ä½¿ç”¨äº†è¿™ç§æ–¹æ³•ï¼Œæˆ‘ä¹Ÿä¸èƒ½è®©webhookç¨³å®šè§¦å‘ã€‚è‡³å°‘æ˜¯æˆ‘ä½¿ç”¨Gitea Webhookæä¾›çš„å‡äº‹ä»¶æ— æ³•è§¦å‘ã€‚</del>çœ‹èµ·æ¥ä¸æ˜¯jenkinsçš„é—®é¢˜ï¼Œå‡äº‹ä»¶çš„ç¡®æ— æ³•è§¦å‘ï¼Œä½†æ¯æ¬¡æäº¤éƒ½èƒ½æ­£å¸¸è§¦å‘æ„å»ºï¼Œè¿™æ ·å°±ç®—æ˜¯è§£å†³äº†é—®é¢˜ã€‚</p>
<h3 id="4.-gitea%E7%9A%84%E7%89%88%E6%9C%AC%E9%97%AE%E9%A2%98">4. giteaçš„ç‰ˆæœ¬é—®é¢˜</h3>
<p>å’Œjenkinsä¸€æ ·ï¼Œé»˜è®¤çš„<code>latest</code>æ ‡ç­¾å¹¶ä¸æ˜¯æœ€æ–°ç‰ˆï¼Œä¹Ÿå¾—ä¸ŠDocker Hubæ‰‹åŠ¨æœgiteaå¹¶ç¡®å®šæœ€æ–°ç‰ˆã€‚æ¯”å¦‚ç›®å‰çš„æœ€æ–°ç‰ˆæ˜¯<code>gitea/gitea:1.20-nightly</code>ã€‚</p>
<p>å¦å¤–é™„ä¸Šgiteaæ™®é€šç‰ˆå’Œnightlyç‰ˆçš„åŒºåˆ«ï¼š</p>
<blockquote>
<p>ä½ å¥½ï¼Œè¿™æ˜¯Bingã€‚æˆ‘å¯ä»¥å¸®ä½ æ‰¾åˆ°ä¸€äº›å…³äºgiteaæ™®é€šç‰ˆå’Œgitea nightlyçš„åŒºåˆ«çš„ä¿¡æ¯ã€‚ğŸ˜Š<br />
æ ¹æ®æˆ‘çš„æœç´¢ç»“æœï¼Œgiteaæ™®é€šç‰ˆæ˜¯æŒ‡giteaçš„æ­£å¼å‘å¸ƒç‰ˆæœ¬ï¼Œå®ƒç»è¿‡äº†å……åˆ†çš„æµ‹è¯•å’ŒéªŒè¯ï¼Œä¿è¯äº†ç¨³å®šæ€§å’Œå®‰å…¨æ€§ã€‚gitea nightlyæ˜¯æŒ‡giteaçš„æ¯æ—¥æ„å»ºç‰ˆæœ¬ï¼Œå®ƒåŒ…å«äº†æœ€æ–°çš„å¼€å‘è¿›å±•å’ŒåŠŸèƒ½ï¼Œä½†å¯èƒ½å­˜åœ¨ä¸€äº›é”™è¯¯å’Œé—®é¢˜ã€‚<br />
å¦‚æœä½ æƒ³ä½¿ç”¨giteaçš„æœ€æ–°åŠŸèƒ½å’Œç‰¹æ€§ï¼Œä½ å¯ä»¥é€‰æ‹©gitea nightlyï¼Œä½†ä½ éœ€è¦æ³¨æ„å¤‡ä»½ä½ çš„æ•°æ®å’Œé…ç½®ï¼Œå¹¶ä¸”åŠæ—¶åé¦ˆä»»ä½•é—®é¢˜ã€‚å¦‚æœä½ æƒ³ä½¿ç”¨giteaçš„ç¨³å®šç‰ˆæœ¬ï¼Œä½ å¯ä»¥é€‰æ‹©giteaæ™®é€šç‰ˆï¼Œä½†ä½ å¯èƒ½æ— æ³•äº«å—åˆ°ä¸€äº›æ–°çš„æ”¹è¿›å’Œä¼˜åŒ–ã€‚<br />
ä½ å¯ä»¥åœ¨è¿™é‡Œä¸‹è½½giteaçš„ä¸åŒç‰ˆæœ¬ï¼š<a href="https://dl.gitea.io/gitea/"  target="_blank">https://dl.gitea.io/gitea/</a><br />
å¸Œæœ›è¿™äº›ä¿¡æ¯å¯¹ä½ æœ‰å¸®åŠ©ã€‚å¦‚æœä½ è¿˜æœ‰å…¶ä»–é—®é¢˜ï¼Œæ¬¢è¿ç»§ç»­æé—®ã€‚ğŸ˜Š</p>
</blockquote>
<h3 id="5.-%E6%96%B0%E7%89%88gitea%E7%9A%84Webhook%E6%8A%A5%E9%94%99-webhook.ALLOWED_HOST_LIST">5. æ–°ç‰ˆgiteaçš„WebhookæŠ¥é”™ webhook.ALLOWED_HOST_LIST</h3>
<p>ä½¿ç”¨æ–°ç‰ˆï¼ˆ1.20ï¼‰giteaï¼Œåœ¨æµ‹è¯•åˆ°jenkinsçš„webhookæ—¶ï¼Œæ— æ³•æ¨é€ï¼ŒæŠ¥é”™å¦‚ä¸‹ï¼š</p>

<pre class="language-text"><code class="language-text">Delivery: Post &quot;http://jenkins:8080/gitea-webhook/post&quot;: dial tcp 172.26.0.2:8080: webhook can only call allowed HTTP servers (check your webhook.ALLOWED_HOST_LIST setting), deny 'jenkins(172.26.0.2:8080)'
</code></pre>
<p>åŸå› æ˜¯giteaæ— æ³•å‘é€postè¯·æ±‚ï¼Œå› ä¸ºæ–°ç‰ˆgiteaé»˜è®¤ç¦ç”¨äº†webhookï¼ˆï¼Ÿï¼Ÿï¼Ÿwhyï¼Ÿï¼Ÿï¼Ÿï¼‰ï¼Œåœ¨<code>/data/gitea/conf/app.ini</code>ä¸­åŠ ä¸Šï¼š</p>

<pre class="language-text"><code class="language-text">[webhook]
ALLOWED_HOST_LIST = *
</code></pre>
<p>ä¹‹åé‡å¯å®¹å™¨ï¼ˆ<code>docker container restart gitea</code>ï¼‰å³å¯ã€‚</p>
<p>å‚è€ƒï¼š<a href="https://discourse.gitea.io/t/webhook-webhook-allowed-host-list-setting/4655"  target="_blank">WebhookæŠ¥é”™ webhook.ALLOWED_HOST_LIST</a></p>

                        
                    </div>
                </div>
                <div id="previous_next">
                    <div id="previous">
                        
                        <a href="/é¦™æ©™æ´¾/åŸºç¡€è®¾ç½®.html">
                            <span class="icon"></span>
                            <span class="label">åŸºç¡€è®¾ç½®</span>
                        </a>
                        
                    </div>
                    <div id="next">
                        
                        <a href="/é¦™æ©™æ´¾/armbian.html">
                            <span class="label">armbian</span>
                            <span class="icon"></span>
                        </a>
                        
                    </div>
                </div>
                <div id="comments-container"></div>
            </div>
            <div id="toc_wrapper">
                <div id="toc">
                    <div id="toc_content">
                            
                    </div>
                </div>
            </div>
        </div>
    </div>
    <a id="to_top" href="#"></a>
    <div id="doc_footer">
        <div id="footer">
            <div id="footer_top">
                <ul>
<li><a></a><ul><li><a target="_blank" href="/#"></a></li>
</ul>
</li>
</ul>

            </div>
            <div id="footer_bottom">
                <ul>
<li><a target="_blank" href="https://github.com/teedoc/teedoc">Generated by teedoc</a></li>
</ul>

            </div>
        </div>
    </div>
    
        <script src="/teedoc-plugin-markdown-parser/mermaid.min.js"></script>
    
        <script>mermaid.initialize({startOnLoad:true});</script>
    
        <script src="/static/js/theme_default/tocbot.min.js"></script>
    
        <script src="/static/js/theme_default/main.js"></script>
    
        <script src="/static/js/theme_default/viewer.min.js"></script>
    
        <script src="/static/css/theme_default/prism.min.js"></script>
    
        <script src="/static/js/search/search_main.js"></script>
    
        <script src="/static/js/custom.js"></script>
    
</body>

</html>